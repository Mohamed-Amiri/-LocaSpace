<div class="auth-container">
  <!-- Modern Form Panel -->
  <div class="form-panel">
    <div class="form-content">
      <div class="form-header">
        <div class="logo-container">
          <svg width="40" height="40" viewBox="0 0 32 32" class="logo-icon">
            <rect width="32" height="32" rx="8" fill="url(#gradient)"/>
            <path d="M8 12h16v8H8z" fill="white" opacity="0.9"/>
            <path d="M12 8h8v4h-8z" fill="white" opacity="0.7"/>
            <defs>
              <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#2563EB"/>
                <stop offset="100%" style="stop-color:#7C3AED"/>
              </linearGradient>
            </defs>
          </svg>
          <span class="logo-text">LocaSpace</span>
        </div>
        <h2>Réinitialiser votre mot de passe</h2>
        <p>Créez un nouveau mot de passe sécurisé pour votre compte</p>
      </div>

      <form class="reset-password-form" [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()" novalidate>
        <!-- Password Input -->
        <div class="input-group" [class.focused]="passwordFocused" [class.has-value]="!!resetPasswordForm.get('password')?.value">
          <div class="input-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
            </svg>
          </div>
          <div class="input-wrapper">
            <label for="password">Nouveau mot de passe</label>
            <input 
              [type]="passwordVisible ? 'text' : 'password'" 
              id="password" 
              formControlName="password" 
              [ngClass]="{ 'is-invalid': submitted && f['password'].errors }"
              (focus)="passwordFocused = true"
              (blur)="passwordFocused = false"
            >
            <button type="button" class="password-toggle" (click)="togglePasswordVisibility()" [attr.aria-label]="passwordVisible ? 'Masquer le mot de passe' : 'Afficher le mot de passe'">
              <svg *ngIf="!passwordVisible" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                <circle cx="12" cy="12" r="3"/>
              </svg>
              <svg *ngIf="passwordVisible" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
                <line x1="1" y1="1" x2="23" y2="23"/>
              </svg>
            </button>
          </div>
          <div *ngIf="submitted && f['password'].errors" class="invalid-feedback">
            <div *ngIf="f['password'].errors['required']">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
              </svg>
              Le mot de passe est requis
            </div>
            <div *ngIf="f['password'].errors['minlength']">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
              </svg>
              Le mot de passe doit contenir au moins 6 caractères
            </div>
          </div>
        </div>
        
        <!-- Confirm Password Input -->
        <div class="input-group" [class.focused]="confirmPasswordFocused" [class.has-value]="!!resetPasswordForm.get('confirmPassword')?.value">
          <div class="input-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
              <path d="M12 16v.01"/>
            </svg>
          </div>
          <div class="input-wrapper">
            <label for="confirmPassword">Confirmer le mot de passe</label>
            <input 
              [type]="confirmPasswordVisible ? 'text' : 'password'" 
              id="confirmPassword" 
              formControlName="confirmPassword" 
              [ngClass]="{ 'is-invalid': submitted && (f['confirmPassword'].errors || resetPasswordForm.errors?.['mismatch']) }"
              (focus)="confirmPasswordFocused = true"
              (blur)="confirmPasswordFocused = false"
            >
            <button type="button" class="password-toggle" (click)="toggleConfirmPasswordVisibility()" [attr.aria-label]="confirmPasswordVisible ? 'Masquer le mot de passe' : 'Afficher le mot de passe'">
              <svg *ngIf="!confirmPasswordVisible" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                <circle cx="12" cy="12" r="3"/>
              </svg>
              <svg *ngIf="confirmPasswordVisible" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
                <line x1="1" y1="1" x2="23" y2="23"/>
              </svg>
            </button>
          </div>
          <div *ngIf="submitted && (f['confirmPassword'].errors || resetPasswordForm.errors?.['mismatch'])" class="invalid-feedback">
            <div *ngIf="f['confirmPassword'].errors?.['required']">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
              </svg>
              La confirmation est requise
            </div>
            <div *ngIf="resetPasswordForm.errors?.['mismatch']">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
              </svg>
              Les mots de passe ne correspondent pas
            </div>
          </div>
        </div>
        
        <!-- Password Strength Indicator -->
        <div class="password-strength" *ngIf="resetPasswordForm.get('password')?.value">
          <div class="strength-label">
            <span>Force du mot de passe:</span>
            <span [class]="'strength-text ' + passwordStrengthClass">{{ passwordStrengthText }}</span>
          </div>
          <div class="strength-meter">
            <div class="strength-bar" [class]="passwordStrengthClass" [style.width.%]="passwordStrengthPercent"></div>
          </div>
          <div class="strength-tips">
            <div class="tip" [class.fulfilled]="hasMinLength">
              <svg *ngIf="hasMinLength" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <polyline points="22 4 12 14.01 9 11.01"/>
              </svg>
              <svg *ngIf="!hasMinLength" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
              </svg>
              <span>Au moins 6 caractères</span>
            </div>
            <div class="tip" [class.fulfilled]="hasUpperCase">
              <svg *ngIf="hasUpperCase" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <polyline points="22 4 12 14.01 9 11.01"/>
              </svg>
              <svg *ngIf="!hasUpperCase" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
              </svg>
              <span>Au moins 1 majuscule</span>
            </div>
            <div class="tip" [class.fulfilled]="hasNumber">
              <svg *ngIf="hasNumber" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <polyline points="22 4 12 14.01 9 11.01"/>
              </svg>
              <svg *ngIf="!hasNumber" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
              </svg>
              <span>Au moins 1 chiffre</span>
            </div>
          </div>
        </div>
        
        <!-- Submit Button -->
        <button type="submit" class="submit-btn" [disabled]="isLoading">
          <span *ngIf="!isLoading">Réinitialiser le mot de passe</span>
          <div *ngIf="isLoading" class="spinner"></div>
        </button>
      </form>

      <!-- Success Message -->
      <div class="success-message" *ngIf="resetSuccess">
        <div class="success-icon">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
            <polyline points="22 4 12 14.01 9 11.01"/>
          </svg>
        </div>
        <h3>Mot de passe réinitialisé !</h3>
        <p>Votre mot de passe a été modifié avec succès. Vous pouvez maintenant vous connecter avec votre nouveau mot de passe.</p>
        <button class="btn-primary" routerLink="/login">Se connecter</button>
      </div>

      <div class="form-footer">
        <p>Vous vous souvenez de votre mot de passe ? <a routerLink="/login" class="login-link">Connectez-vous</a></p>
      </div>
    </div>
  </div>

  <!-- Visual Panel -->
  <div class="visual-panel">
    <div class="visual-overlay"></div>
    <div class="visual-content">
      <div class="quote-container">
        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
          <path d="M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z"/>
          <path d="M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z"/>
        </svg>
        <h3>La sécurité de votre compte est notre priorité. Avec LocaSpace, vos données sont toujours protégées.</h3>
        <div class="testimonial-author">
          <img src="https://randomuser.me/api/portraits/men/54.jpg" alt="Photo de Pierre Durand" class="author-avatar">
          <div class="author-info">
            <p class="author-name">Pierre Durand</p>
            <p class="author-title">Responsable sécurité</p>
          </div>
        </div>
      </div>
      
      <div class="features-list">
        <div class="feature-item">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
          </svg>
          <span>Cryptage de bout en bout</span>
        </div>
        <div class="feature-item">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
          </svg>
          <span>Protection contre les intrusions</span>
        </div>
        <div class="feature-item">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
            <polyline points="22 4 12 14.01 9 11.01"/>
          </svg>
          <span>Authentification sécurisée</span>
        </div>
      </div>
    </div>
  </div>
</div>